Based on work of:

Qiang Xue <qiang.xue@gmail.com> - from CBaseController of Yii framework